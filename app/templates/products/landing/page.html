{% extends "layout.html" %}

{% block title %}{{ product.meta_title or product.name }} | {{ config.platform_name }}{% endblock %}

{% block head %}
{{ super() }}
<!-- SEO Meta Tags -->
<meta name="description" content="{{ product.meta_description }}">
<meta property="og:title" content="{{ product.meta_title or product.name }}">
<meta property="og:description" content="{{ product.meta_description }}">
{% if product.banner_image %}
<meta property="og:image" content="{{ url_for('static', filename='uploads/products/' + product.banner_image) }}">
{% endif %}
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="py-5 bg-light">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-7" data-aos="fade-right">
        <h1 class="display-4 fw-bold mb-4">{{ product.banner_text or product.name }}</h1>
        <p class="lead mb-4">{{ product.short_description }}</p>
        
        <div class="d-flex gap-3 mb-4">
          {% if current_user.is_authenticated %}
            <a href="{{ url_for('products.purchase', product_id=product.id) }}" class="btn btn-primary">
              <i class="fas fa-shopping-cart me-2"></i>Purchase for ${{ product.price }}
            </a>
          {% else %}
            <a href="{{ url_for('auth.login', next=request.path) }}" class="btn btn-primary">
              <i class="fas fa-sign-in-alt me-2"></i>Login to Purchase
            </a>
            <a href="{{ url_for('auth.register', next=request.path) }}" class="btn btn-outline-primary">
              <i class="fas fa-user-plus me-2"></i>Create Account
            </a>
          {% endif %}
        </div>
      </div>
      
      <div class="col-lg-5" data-aos="fade-left">
        {% if product.banner_image %}
          <img src="{{ url_for('static', filename='uploads/products/' + product.banner_image) }}" 
               alt="{{ product.name }}" class="img-fluid rounded-3 shadow">
        {% elif product.image_url %}
          <img src="{{ url_for('static', filename='uploads/products/' + product.image_url) }}" 
               alt="{{ product.name }}" class="img-fluid rounded-3 shadow">
        {% else %}
          <div class="bg-primary text-white rounded-3 p-5 text-center shadow">
            <i class="fas fa-box fa-5x mb-3"></i>
            <h3 class="fw-bold">{{ product.name }}</h3>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>

<!-- Promo Video Section (if available) -->
{% if product.promo_video_url %}
<section class="py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10" data-aos="fade-up">
        <div class="ratio ratio-16x9 rounded-3 shadow overflow-hidden">
          <iframe src="{{ product.promo_video_url }}" 
                  title="{{ product.name }} - Promo Video" 
                  allowfullscreen></iframe>
        </div>
      </div>
    </div>
  </div>
</section>
{% endif %}

<!-- Benefits Section -->
<section class="py-5 bg-light">
  <div class="container">
    <div class="row justify-content-center mb-5">
      <div class="col-lg-8 text-center" data-aos="fade-up">
        <h2 class="fw-bold mb-3">Product Benefits</h2>
        <p class="lead">Why this product is perfect for you</p>
      </div>
    </div>
    
    <div class="row g-4">
      {% if product.benefits %}
        {% set benefits = product.benefits|fromjson %}
        {% for benefit in benefits %}
          <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="{{ loop.index * 100 }}">
            <div class="card h-100 border-0 shadow-sm">
              <div class="card-body">
                <div class="d-flex align-items-center mb-3">
                  <div class="bg-primary bg-opacity-10 p-3 rounded-circle me-3">
                    <i class="fas fa-check text-primary"></i>
                  </div>
                  <h5 class="card-title mb-0 fw-bold">{{ benefit.title }}</h5>
                </div>
                <p class="card-text">{{ benefit.description }}</p>
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="col-12 text-center">
          <p>This product offers exceptional quality and features designed to meet your needs.</p>
        </div>
      {% endif %}
    </div>
  </div>
</section>

<!-- Detailed Description -->
{% if product.detailed_description %}
<section class="py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10" data-aos="fade-up">
        <h2 class="fw-bold mb-4">Product Details</h2>
        <div class="product-description">
          {{ product.detailed_description|safe }}
        </div>
      </div>
    </div>
  </div>
</section>
{% endif %}

<!-- FAQ Section -->
{% if product.faq %}
<section class="py-5 bg-light">
  <div class="container">
    <div class="row justify-content-center mb-5">
      <div class="col-lg-8 text-center" data-aos="fade-up">
        <h2 class="fw-bold mb-3">Frequently Asked Questions</h2>
        <p class="lead">Everything you need to know about this product</p>
      </div>
    </div>
    
    <div class="row justify-content-center">
      <div class="col-lg-10" data-aos="fade-up">
        <div class="accordion" id="faqAccordion">
          {% set faqs = product.faq|fromjson %}
          {% for faq in faqs %}
            <div class="accordion-item border-0 mb-3 shadow-sm">
              <h3 class="accordion-header" id="heading{{ loop.index }}">
                <button class="accordion-button {% if not loop.first %}collapsed{% endif %} fw-bold" 
                        type="button" 
                        data-bs-toggle="collapse" 
                        data-bs-target="#collapse{{ loop.index }}" 
                        aria-expanded="{{ 'true' if loop.first else 'false' }}" 
                        aria-controls="collapse{{ loop.index }}">
                  {{ faq.question }}
                </button>
              </h3>
              <div id="collapse{{ loop.index }}" 
                   class="accordion-collapse collapse {% if loop.first %}show{% endif %}" 
                   aria-labelledby="heading{{ loop.index }}" 
                   data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                  {{ faq.answer|safe }}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>
{% endif %}

<!-- Call to Action -->
<section class="py-5 bg-primary text-white">
  <div class="container">
    <div class="row justify-content-center text-center">
      <div class="col-lg-8" data-aos="fade-up">
        <h2 class="fw-bold mb-4">Ready to Get Started?</h2>
        <p class="lead mb-4">Join thousands of satisfied customers who have already purchased this product.</p>
        
        {% if current_user.is_authenticated %}
          <a href="{{ url_for('products.purchase', product_id=product.id) }}" class="btn btn-light btn-lg">
            <i class="fas fa-shopping-cart me-2"></i>Purchase for ${{ product.price }}
          </a>
        {% else %}
          <a href="{{ url_for('auth.login', next=request.path) }}" class="btn btn-light btn-lg">
            <i class="fas fa-sign-in-alt me-2"></i>Login to Purchase
          </a>
          <a href="{{ url_for('auth.register', next=request.path) }}" class="btn btn-outline-light btn-lg ms-3">
            <i class="fas fa-user-plus me-2"></i>Create Account
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
  // Initialize AOS animations
  AOS.init({
    duration: 800,
    once: true
  });
  
  // Add custom JavaScript for the landing page here
  document.addEventListener('DOMContentLoaded', function() {
    console.log('Product landing page loaded');
  });
</script>
{% endblock %}